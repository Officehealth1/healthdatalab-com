<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-G3ENNWVVWY"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-G3ENNWVVWY');
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Health Reports — HealthDataLab</title>
  <meta name="description"
    content="Get your own longevity report. No practitioner needed. Order a personal health assessment and track your longevity journey over time.">
  <meta property="og:title" content="Personal Health Reports — HealthDataLab">
  <meta property="og:description"
    content="Get your own longevity report. No practitioner needed. Order a personal health assessment and track your longevity journey over time.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://healthdatalab.com/personal-report">
  <link rel="canonical" href="https://healthdatalab.com/personal-report">
  <meta name="twitter:card" content="summary">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/images/apple-touch-icon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@400;500;600;700&display=swap"
    rel="stylesheet">
  <script src="https://js.stripe.com/v3/"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style id="currency-cloak">
    [data-price], #currency-selector, #currency-disclaimer {
      visibility: hidden;
    }
  </style>
  <script>
  (function(){
    var S={GBP:1,USD:1,EUR:1,CHF:1,CAD:1,AUD:1};
    var m; try{m=localStorage.getItem('hdl_currency')}catch(e){}
    if(m&&S[m]){window.__targetCurrency=m;window.__currencySource='manual';return}
    var c=(document.cookie.match(/hdl_geo_currency=([A-Z]{3})/)||[])[1];
    if(c&&S[c]){window.__targetCurrency=c;window.__currencySource='geo';return}
    window.__targetCurrency='GBP';window.__currencySource='default';
  })();
  </script>
  <style type="text/tailwindcss">
    @theme {
      --font-heading: 'Poppins', system-ui, sans-serif;
      --font-sans: 'Inter', system-ui, sans-serif;
      --color-primary: #3d8da0;
      --color-primary-dark: #2e7a8d;
      --color-dark: #111111;
      --color-dark-2: #131313;
      --color-body: #595959;
      --color-muted: #a0a0a0;
      --color-light: #edeef1;
      --color-surface: #ffffff;
      --color-stroke: #e5e7eb;
    }
  </style>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>

<body class="bg-surface text-body font-sans">

  <!-- NAV -->
  <nav id="nav" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
    <div class="max-w-[1280px] mx-auto px-5 md:px-[52px]">
      <div id="nav-inner"
        class="flex items-center justify-between rounded-[48px] px-5 py-3 mt-3 transition-all duration-300">
        <a href="/" class="select-none"><img src="assets/images/hdl-logo-full.png" alt="HealthDataLab" class="h-9"></a>
        <div class="hidden md:flex items-center gap-6">
          <a href="/" class="text-sm text-body hover:text-dark transition-colors">For Practitioners</a>
          <a href="/#how-it-works" class="text-sm text-body hover:text-dark transition-colors">How It Works</a>
          <a href="/personal-report.html" class="text-sm text-dark font-medium transition-colors">For Individuals</a>
          <a href="/#founder-access" class="text-sm text-body hover:text-dark transition-colors">Pricing</a>
          <button onclick="openContactModal()" class="text-sm text-body hover:text-dark transition-colors cursor-pointer">Contact</button>
          <a href="/#founder-access"
            class="inline-flex items-center rounded-[48px] bg-dark text-white text-sm font-medium px-5 py-2.5 hover:bg-dark-2 transition-colors">
            Get Early Access
          </a>
        </div>
        <button id="menu-toggle" class="md:hidden text-dark p-1" aria-label="Menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path id="menu-line-1" stroke-linecap="round" d="M4 7h16"
              class="origin-center transition-transform duration-200" />
            <path id="menu-line-2" stroke-linecap="round" d="M4 12h16" class="transition-opacity duration-200" />
            <path id="menu-line-3" stroke-linecap="round" d="M4 17h16"
              class="origin-center transition-transform duration-200" />
          </svg>
        </button>
      </div>
    </div>
    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden md:hidden">
      <div class="mx-5 md:mx-[52px] mt-2 rounded-[32px] bg-surface border border-stroke/50 shadow-lg">
        <div class="flex flex-col gap-1 px-6 py-5">
          <a href="/" class="nav-link block py-2.5 text-body hover:text-dark text-sm transition-colors">For
            Practitioners</a>
          <a href="/#how-it-works" class="nav-link block py-2.5 text-body hover:text-dark text-sm transition-colors">How
            It Works</a>
          <a href="/personal-report.html" class="nav-link block py-2.5 text-dark font-medium text-sm transition-colors">For
            Individuals</a>
          <a href="/#founder-access"
            class="nav-link block py-2.5 text-body hover:text-dark text-sm transition-colors">Pricing</a>
          <button onclick="openContactModal()" class="nav-link block py-2.5 text-body hover:text-dark text-sm transition-colors text-left cursor-pointer">Contact</button>
          <a href="/#founder-access"
            class="nav-link mt-2 flex items-center justify-center rounded-[48px] bg-dark text-white text-sm font-medium px-5 py-3 hover:bg-dark-2 transition-colors">Get
            Early Access</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <section class="bg-gradient-to-b from-surface to-light overflow-hidden">
    <div class="max-w-[1280px] mx-auto px-5 md:px-[52px] pt-36 pb-24 md:pt-44 md:pb-36 text-center">
      <div class="max-w-3xl mx-auto">
        <p class="hero-enter hero-enter-1 text-sm text-primary font-medium mb-6">
          For individuals
        </p>
        <h1 class="hero-enter hero-enter-2 font-heading text-[clamp(2rem,5vw,3rem)] font-medium text-dark leading-[1.16] tracking-[-0.03em]">
          Get your own longevity report
        </h1>
        <p class="hero-enter hero-enter-3 mt-6 text-lg text-body max-w-xl mx-auto leading-relaxed">
          No practitioner needed. Order a personal health assessment and track your longevity journey over time.
        </p>
      </div>
    </div>
  </section>

  <!-- PRICING -->
  <section class="bg-light">
    <div class="max-w-[1280px] mx-auto px-5 md:px-[52px] py-24 md:py-32">
      <!-- Currency Selector -->
      <div id="currency-selector" class="text-center mb-8">
        <label class="inline-flex items-center gap-2 bg-primary text-white text-sm font-medium rounded-full px-4 py-2 cursor-pointer">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5a17.92 17.92 0 0 1-8.716-2.247m0 0A8.966 8.966 0 0 1 3 12c0-1.528.38-2.968 1.05-4.228" /></svg>
          <select id="currency-select" class="bg-transparent text-white border-none outline-none cursor-pointer text-sm font-medium appearance-none pr-1" onchange="updateCurrencyDisplay(this.value)">
            <option value="GBP" class="text-dark">£ GBP</option>
            <option value="USD" class="text-dark">$ USD</option>
            <option value="EUR" class="text-dark">€ EUR</option>
            <option value="CHF" class="text-dark">CHF</option>
            <option value="CAD" class="text-dark">C$ CAD</option>
            <option value="AUD" class="text-dark">A$ AUD</option>
          </select>
        </label>
      </div>
      <p id="currency-disclaimer" class="hidden text-center text-xs text-muted mb-6">Prices shown in <span id="currency-label">GBP</span>. Final amount may vary slightly due to exchange rate fluctuations.</p>

      <div class="grid gap-6 md:grid-cols-2 max-w-2xl mx-auto">

        <!-- Single Report -->
        <div class="reveal-scale bg-surface rounded-[32px] p-8 border border-stroke/50 hover:border-primary/30 transition-colors">
          <div class="flex flex-col h-full">
            <div>
              <h3 class="font-heading text-xl font-semibold text-dark">Single Report</h3>
              <p class="mt-2 text-sm text-muted">One-time health assessment</p>
            </div>
            <div class="mt-6">
              <div class="flex items-baseline gap-1">
                <span id="single-price" class="font-heading text-4xl font-bold text-dark" data-price>£9.99</span>
              </div>
              <p class="mt-2 text-xs text-muted">One-time payment</p>
            </div>
            <div class="mt-8 flex-1 flex flex-col justify-end">
              <button onclick="checkout('consumer_single')"
                class="w-full inline-flex items-center justify-center gap-2 rounded-[48px] border-2 border-primary text-primary text-base font-medium px-8 py-3.5 hover:bg-primary hover:text-white transition-colors">
                Order Report
              </button>
            </div>
          </div>
        </div>

        <!-- Annual Pass (Best Value) -->
        <div class="reveal-scale reveal-delay-1 bg-surface rounded-[32px] p-8 ring-2 ring-primary border border-primary/20 relative">
          <div class="absolute -top-3 left-1/2 -translate-x-1/2">
            <span class="inline-block bg-primary text-white text-xs font-semibold px-3 py-1 rounded-full">Best Value</span>
          </div>
          <div class="flex flex-col h-full">
            <div>
              <h3 class="font-heading text-xl font-semibold text-dark">Annual Pass</h3>
              <p class="mt-2 text-sm text-muted">Up to 4 reports per year. Track your progress over time.</p>
            </div>
            <div class="mt-6">
              <div class="flex items-baseline gap-1">
                <span id="annual-price" class="font-heading text-4xl font-bold text-dark" data-price>£19.99</span>
                <span class="text-muted">/year</span>
              </div>
              <p id="annual-per-report" class="mt-2 text-xs text-primary font-medium" data-price>Just £5.00 per report</p>
            </div>
            <div class="mt-8 flex-1 flex flex-col justify-end">
              <button onclick="checkout('consumer_annual')"
                class="w-full inline-flex items-center justify-center gap-2 rounded-[48px] bg-primary text-white text-base font-medium px-8 py-3.5 hover:bg-primary-dark transition-colors shadow-[0_4px_20px_rgba(61,141,160,.25)]">
                Get Annual Pass
              </button>
            </div>
          </div>
        </div>

      </div>

      <p class="mt-10 text-center text-sm text-body">
        Are you a practitioner? <a href="/" class="text-primary font-medium hover:text-primary-dark transition-colors">See our professional plans &rarr;</a>
      </p>

      <!-- Success message -->
      <div id="success-message" class="hidden mt-8 max-w-2xl mx-auto">
        <div class="bg-surface border border-stroke/50 rounded-[32px] p-8 md:p-10">
          <div class="text-center mb-8">
            <div class="mx-auto w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center mb-4">
              <svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/>
              </svg>
            </div>
            <h3 class="font-heading text-xl font-semibold text-dark">Purchase complete</h3>
          </div>
          <div class="flex flex-col gap-5">
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                <span class="text-sm font-semibold text-primary">1</span>
              </div>
              <div>
                <p class="text-sm font-medium text-dark">Check your email</p>
                <p class="text-sm text-body mt-0.5">We've sent a welcome email with your login link.</p>
              </div>
            </div>
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                <span class="text-sm font-semibold text-primary">2</span>
              </div>
              <div>
                <p class="text-sm font-medium text-dark">Log in with one click</p>
                <p class="text-sm text-body mt-0.5">Click the button in the email to access your account instantly.</p>
              </div>
            </div>
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0 w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                <span class="text-sm font-semibold text-primary">3</span>
              </div>
              <div>
                <p class="text-sm font-medium text-dark">Complete your assessment</p>
                <p class="text-sm text-body mt-0.5">Fill in the longevity questionnaire and get your personalised report.</p>
              </div>
            </div>
          </div>
          <p class="mt-6 text-center text-xs text-muted">Didn't receive the email? Check your spam folder or <button onclick="openContactModal()" class="text-primary hover:text-primary-dark transition-colors cursor-pointer">contact us</button>.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="bg-dark text-white">
    <div class="max-w-[1280px] mx-auto px-5 md:px-[52px] py-16 md:py-20">
      <div class="reveal grid gap-10 md:grid-cols-3">
        <div>
          <p class="font-heading text-lg font-semibold tracking-tight">HealthDataLab</p>
          <p class="mt-3 text-sm text-white/40 leading-relaxed">Built for holistic health practitioners.</p>
          <p class="mt-2 text-xs text-white/25">From the makers of IRISLAB.com</p>
          <button onclick="openContactModal()"
            class="mt-4 inline-flex items-center gap-2 text-sm text-white/50 hover:text-white transition-colors cursor-pointer">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
            </svg>
            Contact us
          </button>
        </div>
        <div>
          <p class="text-xs font-medium tracking-wide text-white/30 uppercase mb-4">Quick links</p>
          <div class="flex flex-col gap-2.5">
            <a href="/" class="text-sm text-white/50 hover:text-white transition-colors">For Practitioners</a>
            <a href="/#how-it-works" class="text-sm text-white/50 hover:text-white transition-colors">How It Works</a>
            <a href="/#founder-access" class="text-sm text-white/50 hover:text-white transition-colors">Founder
              Access</a>
          </div>
        </div>
        <div>
          <p class="text-xs font-medium tracking-wide text-white/30 uppercase mb-4">Legal</p>
          <div class="flex flex-col gap-2.5">
            <a href="/privacy.html"
              class="text-sm text-white/50 hover:text-white transition-colors">Privacy Policy</a>
            <a href="/terms.html"
              class="text-sm text-white/50 hover:text-white transition-colors">Terms of Service</a>
            <p class="text-xs text-white/30 mt-3 leading-relaxed">Refund Policy: 30-day money-back guarantee on Course and Signature tiers. Minimum: cancel anytime. Launchpad: free tier, cancel anytime.</p>
          </div>
        </div>
      </div>
      <div class="mt-14 border-t border-white/10 pt-8 flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-xs text-white/30">&copy; 2026 HealthDataLab. All rights reserved.</p>
        <p class="text-xs text-white/20">This is not a medical service.</p>
      </div>
    </div>
  </footer>

  <!-- Contact Modal -->
  <div id="contact-modal" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm items-center justify-center opacity-0 transition-opacity duration-300" onclick="closeContactModal()" style="display:none">
    <div class="relative w-[calc(100%-2.5rem)] max-w-lg max-h-[90vh] overflow-y-auto bg-surface rounded-[32px] p-8 md:p-10 shadow-2xl" onclick="event.stopPropagation()">
      <button onclick="closeContactModal()" class="absolute top-5 right-5 text-body hover:text-dark transition-colors cursor-pointer">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
        </svg>
      </button>
      <div id="contact-form-wrapper">
        <h2 class="font-heading text-xl font-medium text-dark">Get in touch</h2>
        <p class="mt-2 text-sm text-body">We'll get back to you within 24 hours.</p>
        <form id="contact-form" name="contact" class="mt-6 flex flex-col gap-4" onsubmit="handleContactSubmit(event)">
          <p class="hidden"><label>Don't fill this out: <input name="bot-field"></label></p>
          <div>
            <label for="contact-name" class="block text-sm font-medium text-dark mb-1.5">Name</label>
            <input type="text" id="contact-name" name="name" required autocomplete="name"
              class="w-full rounded-2xl border border-stroke bg-light px-4 py-3 text-sm text-dark placeholder:text-muted outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors"
              placeholder="Your name">
          </div>
          <div>
            <label for="contact-email" class="block text-sm font-medium text-dark mb-1.5">Email</label>
            <input type="email" id="contact-email" name="email" required autocomplete="email"
              class="w-full rounded-2xl border border-stroke bg-light px-4 py-3 text-sm text-dark placeholder:text-muted outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors"
              placeholder="you@example.com">
          </div>
          <div>
            <label for="contact-subject" class="block text-sm font-medium text-dark mb-1.5">Subject</label>
            <select id="contact-subject" name="subject" required
              class="w-full appearance-none rounded-2xl border border-stroke bg-light px-4 py-3 text-sm text-dark outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors cursor-pointer"
              style="background-image: url('data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 fill=%27none%27 viewBox=%270 0 20 20%27%3E%3Cpath stroke=%27%23a0a0a0%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%271.5%27 d=%27m6 8 4 4 4-4%27/%3E%3C/svg%3E'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 1.25rem;">
              <option value="" disabled selected>Choose a topic</option>
              <option value="General inquiry">General inquiry</option>
              <option value="Personal report">Personal report</option>
              <option value="Technical issue">Technical issue</option>
              <option value="Partnership">Partnership</option>
            </select>
          </div>
          <div>
            <label for="contact-message" class="block text-sm font-medium text-dark mb-1.5">Message</label>
            <textarea id="contact-message" name="message" required rows="4"
              class="w-full rounded-2xl border border-stroke bg-light px-4 py-3 text-sm text-dark placeholder:text-muted outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-colors resize-none"
              placeholder="How can we help?"></textarea>
          </div>
          <button type="submit" id="contact-submit"
            class="mt-2 w-full rounded-[48px] bg-dark text-white text-sm font-medium px-6 py-3.5 hover:bg-dark-2 transition-colors cursor-pointer flex items-center justify-center gap-2">
            <span id="contact-submit-text">Send message</span>
            <svg id="contact-spinner" class="hidden w-4 h-4 animate-spin" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
            </svg>
          </button>
          <p id="contact-error" class="hidden text-sm text-red-500 text-center mt-2"></p>
        </form>
      </div>
      <div id="contact-success" class="hidden text-center py-8">
        <div class="mx-auto w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center mb-4">
          <svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5"/>
          </svg>
        </div>
        <h3 class="font-heading text-lg font-medium text-dark">Message sent!</h3>
        <p class="mt-2 text-sm text-body">We'll get back to you soon.</p>
        <button onclick="closeContactModal()" class="mt-6 rounded-[48px] bg-dark text-white text-sm font-medium px-8 py-3 hover:bg-dark-2 transition-colors cursor-pointer">Close</button>
      </div>
    </div>
  </div>
  <script>
    var _contactCooldown = false;
    function openContactModal() {
      var modal = document.getElementById('contact-modal');
      document.getElementById('contact-form-wrapper').classList.remove('hidden');
      document.getElementById('contact-success').classList.add('hidden');
      var errorDiv = document.getElementById('contact-error');
      if (errorDiv) errorDiv.classList.add('hidden');
      modal.style.display = 'flex';
      requestAnimationFrame(function() {
        requestAnimationFrame(function() { modal.style.opacity = '1'; });
      });
      document.body.style.overflow = 'hidden';
    }
    function closeContactModal() {
      var modal = document.getElementById('contact-modal');
      modal.style.opacity = '0';
      setTimeout(function() { modal.style.display = 'none'; }, 300);
      document.body.style.overflow = '';
    }
    function handleContactSubmit(e) {
      e.preventDefault();
      if (_contactCooldown) return;
      var emailInput = document.getElementById('contact-email');
      var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailPattern.test(emailInput.value)) {
        emailInput.setCustomValidity('Please enter a valid email address');
        emailInput.reportValidity();
        return;
      }
      emailInput.setCustomValidity('');
      var btn = document.getElementById('contact-submit');
      var btnText = document.getElementById('contact-submit-text');
      var spinner = document.getElementById('contact-spinner');
      btn.disabled = true;
      btnText.textContent = 'Sending...';
      spinner.classList.remove('hidden');
      var payload = JSON.stringify({
        name: document.getElementById('contact-name').value,
        email: document.getElementById('contact-email').value,
        subject: document.getElementById('contact-subject').value,
        message: document.getElementById('contact-message').value,
        botField: document.querySelector('[name="bot-field"]').value
      });
      fetch('/.netlify/functions/send-email', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: payload
      }).then(function(res) {
        if (!res.ok) throw new Error('Server returned ' + res.status);
        document.getElementById('contact-form-wrapper').classList.add('hidden');
        document.getElementById('contact-success').classList.remove('hidden');
        _contactCooldown = true;
        setTimeout(function() { _contactCooldown = false; }, 60000);
      }).catch(function(err) {
        btn.disabled = false;
        btnText.textContent = 'Send message';
        spinner.classList.add('hidden');
        var errorDiv = document.getElementById('contact-error');
        if (errorDiv) {
          errorDiv.textContent = 'Something went wrong. Please try again or email office@healthdatalab.com';
          errorDiv.classList.remove('hidden');
        }
      });
    }
    document.getElementById('contact-email').addEventListener('input', function() { this.setCustomValidity(''); });
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        if (document.getElementById('practitioner-modal').style.display === 'flex') handlePractitionerChoice('no');
        else if (document.getElementById('contact-modal').style.display === 'flex') closeContactModal();
      }
    });
  </script>

  <!-- Practitioner Modal -->
  <div id="practitioner-modal" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm items-center justify-center opacity-0 transition-opacity duration-300" onclick="handlePractitionerChoice('no')" style="display:none">
    <div class="relative w-[calc(100%-2.5rem)] max-w-md bg-surface rounded-[32px] p-8 md:p-10 shadow-2xl" onclick="event.stopPropagation()">
      <button onclick="handlePractitionerChoice('no')" class="absolute top-5 right-5 text-body hover:text-dark transition-colors cursor-pointer">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
        </svg>
      </button>
      <div class="text-center mb-6">
        <div class="mx-auto w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center mb-4">
          <svg class="w-7 h-7 text-primary" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"/>
          </svg>
        </div>
        <h2 class="font-heading text-xl font-medium text-dark">Enhance Your Report Experience</h2>
        <p class="mt-3 text-sm text-body leading-relaxed">Would you like to be connected with our in-house naturopath? They can help interpret your results and provide personalised guidance at no extra cost.</p>
      </div>
      <div class="flex flex-col gap-3">
        <button onclick="handlePractitionerChoice('yes')"
          class="w-full rounded-[48px] bg-primary text-white text-sm font-medium px-6 py-3.5 hover:bg-primary-dark transition-colors cursor-pointer">
          Yes, connect me with a practitioner
        </button>
        <button onclick="handlePractitionerChoice('no')"
          class="w-full rounded-[48px] border-2 border-stroke text-body text-sm font-medium px-6 py-3.5 hover:border-dark hover:text-dark transition-colors cursor-pointer">
          No thanks, just my report
        </button>
      </div>
    </div>
  </div>

  <script src="assets/js/main.js"></script>
  <script>
    // Check for success parameter
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('success') === 'true') {
      const cleanUrl = window.location.origin + window.location.pathname;
      window.history.replaceState({}, '', cleanUrl);

      const successMsg = document.getElementById('success-message');
      successMsg.classList.remove('hidden');
      setTimeout(() => {
        successMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }, 300);
    }

    // Stripe checkout
    const stripe = Stripe('pk_live_51T0LeuAARZOPki7nuJiOtjwC48eWIrW05xzKMr666n52jjArjOOBG2NjnNOb3l6Yzay0TpOkIVFhT4EhA7ezGbwj00Nh2fcC4r');

    const PRICE_IDS = {
      consumer_single: 'price_1T2KlHAARZOPki7nx77wtLhj',
      consumer_annual: 'price_1T3944AARZOPki7nWYs5ZCeK',
    };

    const CURRENCY_SYMBOLS = { GBP: '£', USD: '$', EUR: '€', CHF: 'CHF ', CAD: 'C$', AUD: 'A$' };
    const PRICE_AMOUNTS_GBP = { consumer_single: 999, consumer_annual: 1999 };
    window.__exchangeRates = null;
    window.__selectedCurrency = 'GBP';

    function formatPrice(amountPence, currency) {
      const sym = CURRENCY_SYMBOLS[currency] || currency + ' ';
      const val = amountPence / 100;
      const formatted = val % 1 === 0 ? val.toLocaleString('en') : val.toLocaleString('en', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      return sym + formatted;
    }

    function convertAmount(gbpPence, currency) {
      if (currency === 'GBP' || !window.__exchangeRates) return gbpPence;
      return Math.round(gbpPence * window.__exchangeRates[currency]);
    }

    function updateCurrencyDisplay(currency, persist) {
      window.__selectedCurrency = currency;
      if (persist !== false) localStorage.setItem('hdl_currency', currency);
      const disclaimer = document.getElementById('currency-disclaimer');
      if (currency === 'GBP') {
        disclaimer.classList.add('hidden');
      } else {
        document.getElementById('currency-label').textContent = currency;
        disclaimer.classList.remove('hidden');
      }
      const singleConverted = convertAmount(PRICE_AMOUNTS_GBP.consumer_single, currency);
      const annualConverted = convertAmount(PRICE_AMOUNTS_GBP.consumer_annual, currency);
      const perReport = Math.round(annualConverted / 4);
      document.getElementById('single-price').textContent = formatPrice(singleConverted, currency);
      document.getElementById('annual-price').textContent = formatPrice(annualConverted, currency);
      document.getElementById('annual-per-report').textContent = 'Just ' + formatPrice(perReport, currency) + ' per report';
    }

    function revealPrices() {
      var el = document.getElementById('currency-cloak');
      if (el) el.remove();
    }

    (async function() {
      try {
        const res = await fetch('https://api.frankfurter.app/latest?from=GBP&to=USD,EUR,CHF,CAD,AUD');
        if (!res.ok) throw new Error();
        const data = await res.json();
        window.__exchangeRates = data.rates;
        if (!['USD','EUR','CHF','CAD','AUD'].every(c => data.rates[c])) throw new Error('Incomplete');

        var target = window.__targetCurrency || 'GBP';
        document.getElementById('currency-select').value = target;
        if (target !== 'GBP') {
          updateCurrencyDisplay(target, window.__currencySource !== 'geo');
        }
      } catch (e) {
        Array.from(document.getElementById('currency-select').options).forEach(opt => {
          if (opt.value !== 'GBP') opt.disabled = true;
        });
      } finally {
        revealPrices();
      }
    })();
    setTimeout(revealPrices, 3000);

    let _pendingCheckoutTier = null;

    function checkout(tier) {
      _pendingCheckoutTier = tier;
      var modal = document.getElementById('practitioner-modal');
      modal.style.display = 'flex';
      requestAnimationFrame(function() {
        requestAnimationFrame(function() { modal.style.opacity = '1'; });
      });
      document.body.style.overflow = 'hidden';
    }

    function handlePractitionerChoice(choice) {
      var modal = document.getElementById('practitioner-modal');
      modal.style.opacity = '0';
      setTimeout(function() { modal.style.display = 'none'; }, 300);
      document.body.style.overflow = '';
      if (_pendingCheckoutTier) {
        proceedToCheckout(_pendingCheckoutTier, choice);
        _pendingCheckoutTier = null;
      }
    }

    async function proceedToCheckout(tier, practitionerPreference) {
      const priceId = PRICE_IDS[tier];
      const mode = tier === 'consumer_single' ? 'payment' : 'subscription';
      const selectedCurrency = document.getElementById('currency-select').value;
      const baseAmountGBP = PRICE_AMOUNTS_GBP[tier] || 0;
      const recurringInterval = tier === 'consumer_annual' ? 'year' : 'month';
      try {
        const res = await fetch('/.netlify/functions/create-checkout', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            priceId, mode,
            currency: selectedCurrency,
            baseAmountGBP: baseAmountGBP,
            recurringInterval: recurringInterval,
            tier: tier,
            practitionerPreference: practitionerPreference || 'no',
            successUrl: window.location.origin + '/personal-report?success=true',
            cancelUrl: window.location.origin + '/personal-report',
          }),
        });
        const { sessionId, error } = await res.json();
        if (error) throw new Error(error);
        await stripe.redirectToCheckout({ sessionId });
      } catch (err) {
        showToast('error');
      }
    }
  </script>

  <!-- Toast Notifications -->
  <div id="toast-container" class="fixed top-6 right-6 z-[200] flex flex-col gap-3 pointer-events-none"></div>
  <script>
    function showToast(key) {
      var messages = {
        'not-available': { type: 'info', text: 'This option is not yet available. ', suffix: ' for early access.' },
        'error': { type: 'error', text: 'Something went wrong. Please try again or ', suffix: '' }
      };
      var msg = messages[key] || messages['error'];
      var isError = msg.type === 'error';
      var toast = document.createElement('div');
      toast.className = 'pointer-events-auto flex items-start gap-3 max-w-sm px-4 py-3.5 rounded-2xl shadow-lg transition-all duration-300 translate-x-[120%] opacity-0 '
        + (isError ? 'bg-dark text-white border border-white/10' : 'bg-surface text-dark border border-stroke');
      var iconSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      iconSvg.setAttribute('fill', 'none');
      iconSvg.setAttribute('stroke', 'currentColor');
      iconSvg.setAttribute('stroke-width', '1.5');
      iconSvg.setAttribute('viewBox', '0 0 24 24');
      var iconPath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      iconPath.setAttribute('stroke-linecap', 'round');
      iconPath.setAttribute('stroke-linejoin', 'round');
      if (isError) {
        iconSvg.setAttribute('class', 'w-5 h-5 flex-shrink-0 mt-0.5 text-red-400');
        iconPath.setAttribute('d', 'M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z');
      } else {
        iconSvg.setAttribute('class', 'w-5 h-5 flex-shrink-0 mt-0.5 text-primary');
        iconPath.setAttribute('d', 'm11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z');
      }
      iconSvg.appendChild(iconPath);
      toast.appendChild(iconSvg);
      var msgSpan = document.createElement('span');
      msgSpan.className = 'text-sm leading-relaxed flex-1';
      msgSpan.appendChild(document.createTextNode(msg.text));
      var contactBtn = document.createElement('button');
      contactBtn.className = 'text-primary hover:underline cursor-pointer';
      contactBtn.textContent = 'contact us';
      contactBtn.onclick = function() { dismissToast(toast); openContactModal(); };
      msgSpan.appendChild(contactBtn);
      if (msg.suffix) msgSpan.appendChild(document.createTextNode(msg.suffix));
      toast.appendChild(msgSpan);
      var closeBtn = document.createElement('button');
      closeBtn.className = 'flex-shrink-0 mt-0.5 opacity-50 hover:opacity-100 transition-opacity cursor-pointer';
      var closeSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      closeSvg.setAttribute('class', 'w-4 h-4');
      closeSvg.setAttribute('fill', 'none');
      closeSvg.setAttribute('stroke', 'currentColor');
      closeSvg.setAttribute('stroke-width', '2');
      closeSvg.setAttribute('viewBox', '0 0 24 24');
      var closePath = document.createElementNS('http://www.w3.org/2000/svg', 'path');
      closePath.setAttribute('stroke-linecap', 'round');
      closePath.setAttribute('stroke-linejoin', 'round');
      closePath.setAttribute('d', 'M6 18 18 6M6 6l12 12');
      closeSvg.appendChild(closePath);
      closeBtn.appendChild(closeSvg);
      closeBtn.onclick = function() { dismissToast(toast); };
      toast.appendChild(closeBtn);
      document.getElementById('toast-container').appendChild(toast);
      requestAnimationFrame(function() {
        requestAnimationFrame(function() {
          toast.style.transform = 'translateX(0)';
          toast.style.opacity = '1';
        });
      });
      setTimeout(function() { dismissToast(toast); }, 6000);
    }
    function dismissToast(toast) {
      if (toast.dataset.dismissed) return;
      toast.dataset.dismissed = '1';
      toast.style.opacity = '0';
      toast.style.transform = 'translateX(120%)';
      setTimeout(function() { toast.remove(); }, 300);
    }
  </script>

</body>

</html>
